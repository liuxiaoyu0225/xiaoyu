<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>购物车</title>
    <link rel="stylesheet" href="../css/shoppingcar.css">
    <link rel="stylesheet" href="../css/rest.css">
    <link rel="stylesheet" href="//apps.bdimg.com/libs/jqueryui/1.10.4/css/jquery-ui.min.css">

</head>

<body>
    <div class="top" id="top">
        <p class="top-box">生于长野·安于室</p>
    </div>
    <!-- 头部 -->
    <div class="header" id="header">
        <div class="header-box">
            <h1 class="logo-box"> <a href="../index.html"> <img src="../images/index/logo.png" alt=""></a></h1>
            <ul class="header-nav">
                <li class="furniture"> <a href="../index.html" class="selecta">家具</a>
                    <div class="furniture-subnav">
                        <ul>
                            <li><a href="">椅</a> </li>
                            <li> <a href="#zhuo">桌</a></li>
                            <li><a href="">床</a></li>
                            <li> <a href="">几</a></li>
                            <li> <a href="">柜</a> </li>
                            <li> <a href="">沙发</a></li>
                            <li> <a href="">一枚版</a></li>
                            <li class="other"> <a href="">其他</a></li>
                            <li> <a href="">本线</a></li>
                            <li> <a href="">FF线</a></li>

                        </ul>
                    </div>
                </li>

                <li class="home"> <a href="./jiaju.html">家居</a>
                    <div class="home-subnav">
                        <ul>
                            <li> <a href="">咖啡茶具</a> </li>
                            <li> <a href="">餐具</a> </li>
                            <li> <a href="">厨具</a> </li>
                            <li> <a href="">家纺</a> </li>
                            <li> <a href="">香氛</a> </li>
                            <li> <a href="">收纳</a> </li>
                            <li> <a href="">装饰</a> </li>
                            <li> <a href="">养护</a> </li>
                            <li> <a href="">园艺</a> </li>
                            <li> <a href="">户外</a> </li>
                            <li> <a href="">家电</a> </li>
                            <li> <a href="">文具</a> </li>
                            <li> <a href="">配饰</a> </li>
                            <li class="other"> <a href="">其他</a> </li>
                            <li> <a href="">Sale</a> </li>
                        </ul>
                    </div>
                </li>
                <li class="art"> <a href="">艺术</a>
                    <div class="art-subnav">
                        <ul class="art-ul">
                            <li><a href="">艺术家</a></li>
                            <li><a href="">作品</a></li>
                            <li><a href="">展览</a></li>
                        </ul>
                    </div>
                </li>
                <li class="column"> <a href="">栏目</a>
                    <div class="column-subnav">
                        <ul class="column-ul">
                            <li><a href="">梵几在家</a></li>
                            <li><a href="">串门</a></li>
                            <li><a href="">ARTSTACE</a></li>
                        </ul>
                    </div>
                </li>
                <li class="news"> <a href="">新事</a> </li>
            </ul>
            <ul class="header-event">
                <li><img src="../images/index/top1.png" alt=""></li>
                <li><img src="../images/index/top2.png" alt=""></li>
                <li><img src="../images/index/top3.png" alt=""></li>
                <li id="login-tu"><img src="../images/index/top4.png" alt=""></li>
                <!-- <li class="login-zi" id="login-zi"> <a id="register">注册</a> /<a id="login">登录</a> </li> -->
                <li id="denglu-suce"> <a> <img src="../images/index/userimg.png"></a>
                    <p id="cancle-top">退出</p>
                </li>
            </ul>
        </div>
    </div>
    <!-- ---------------------------------------头部结束---------------------------------- -->
    <!-- <div class="shopping-car" >
<div class="shopping-box">
    <ul>
        <li>加入购物车</li>
        <li>生成订单</li>
        <li>激活订单</li>
        <li>付款</li>
    </ul>
    <ul>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
    </ul>

</div>
    </div> -->


    <div class="cartparent" style="height: 361px;">
        <div class="cart container">
            <div class="top">
                <input type="checkbox" name="" class="check-all"> <span class="title">家具</span>
            </div>
            <ul class="header">
                <li class="shangping">商品</li>
                <li class="guige">木色</li>
                <li class="danjia">单价</li>
                <li class="count">数量</li>
                <li class="sum">小计</li>
            </ul>

            <div class="detail">
                    <!-- <div class="item"> -->
                        <!-- <input type="checkbox" name="" class="check-one">
                        <div class="img">
                            <a><img src="../images/xiaoyezitan/xyzt1.jpg"  width="100px"></a>
                        </div>
                        <span class="title doubleline"><a>精品鸡翅木老料长款手链</a></span>
                        <div class="guige">白蜡木</span>
                        </div>
                        <span class="danjia">139.00元</span>
                        <ul class="count">
                            <li class="reduce">-</li>
                            <li>
                                <input type="text" name="goods_number[42046]" id="goods_number_42046" value="1" size="4"
                                    class="txtcount">
                            </li>
                            <li class="add">+</li>
                        </ul>
                        <span class="sum">139.00元</span>
                        <span class="dele" >x</span>
                    </div> -->
                </div>
            <div class="bottom">
                <p class="dele-all">全部删除</p>
                <div class="pay" style="cursor:pointer">
                    去结算
                </div>
                <span class="price">合计：<span id="jiage-heji" >139.00元</span></span>
            </div>
        </div>
    </div>




    <!-- -------------------------------------底部 ------------------------------------->
    <div class="foot">
        <div class="foot-box">
            <ul>
                <li class="foot-title"><a href="">关于我们</a></li>
                <li><a href="">梵几STORY</a></li>
                <li><a href="">梵几实体店</a></li>
                <li><a href="">媒体报道</a></li>
                <li><a href="">招聘信息</a></li>
            </ul>
            <ul>
                <li class="foot-title"><a href="">购物指南</a></li>
                <li><a href="">购物流程</a></li>
                <li><a href="">会员制度</a></li>
            </ul>
            <ul>
                <li class="foot-title"><a href="">关于配送</a></li>
                <li><a href="">家具配送</a></li>
                <li><a href="">家具配送</a></li>
                <li><a href="">一枚版配送</a></li>
            </ul>
            <ul>
                <li class="foot-title"><a href="">售后服务</a></li>
                <li><a href="">家具售后</a></li>
                <li><a href="">家具售后</a></li>
            </ul>
            <ul>
                <li class="foot-title"><a href="">商业合作</a></li>
                <li><a href="">项目批量采购</a></li>
                <li><a href="">设计公司合作</a></li>
                <li><a href="">家具品牌合作</a></li>
                <li><a href="">艺术品合作</a></li>
            </ul>
            <div class="foot-chat">
                <p><a href=""><img src="../images/index/weibo.png" alt=""></a></p>
                <p><a href=""><img src="../images/index/weixin.png" alt=""></a></p>
            </div>
            <div class="copyright ">
                <p>梵几独立家居品牌 &copy 2017 Fnji Interior design Co. Ltd. Beijing, China
                    京ICP备13004049号-3</p>
            </div>
        </div>

    </div>

    <!-- ------------------------------------------- -->

    <!-- 登录遮罩层 -->
    <div class="login-shadow" id="login-shadow">
        <div class="login-box">
            <button class="cancle" id="cancle">x</button>
            <div class="login-box2">
                <div class="login-left">
                    <p class="login-saoma">手机扫码登录</p>
                    <p class="login-weixin"><img src="../images/index/weixinlogin_03.png" alt=""></p>
                    <p class="login-tips">打开微信扫一扫登录</p>
                </div>
                <div class="login-right">
                    <p class="userlogin">账户登录</p>
                    <div class="username-div">
                        <input type="text" name="" class="username" id="username" placeholder="手机或邮箱" title="请输入常用邮箱">
                    </div>
                    <div class="username-div">
                        <input type="text" class="userpwd" id="userpwd" placeholder="密码" title="请输入6到16位字母数字_$符号的密码">
                        <p class="zhuanghu-tips" id="zhuanghu-tips"></p>
                    </div>
                    <p class="remeber-p"><input id="remeber" type="checkbox"> <label for="remeber"
                            class="remeber-label">记住密码</label> <span class="userpad-new"><a href="">忘记密码或账号</a> </span>
                    </p>
                    <button class="denglu" id="denglu">登录</button>
                    <p class="zhuce">还没有梵几账号<a href="">点击注册</a></p>
                    <button class="phone-denglu">手机快捷登录</button>


                </div>
            </div>
        </div>
    </div>
    <!-- 注册遮罩层 -->
    <div class="register-shadow" id="register-shadow">
        <div class="register-box">
            <button class="cancle" id="cancle2">x</button>
            <div class="register-box2">
                <h3>注册</h3>
                <ul>
                    <li class="register-li">
                        <input type="text" title="请输入常用电话号码或者邮箱" placeholder="手机或邮箱" id="register-name">
                        <p class="zhuanghu-tips" id="zhucename-tips"></p>
                    </li>
                    <li class="register-li">
                        <input type="text" title="看不清?点击验证码更新" placeholder="验证码" id="verification-code">
                        <i class="verification" id="verification">1234</i>
                        <p class="zhuanghu-tips" id="zhuceyanzhen-tips"></p>
                    </li>
                    <li class="register-li">
                        <input type="text" title="请输入6到16位字母数字_$符号的密码" placeholder="密码" id="register-pwd">
                        <p class="zhuanghu-tips" id="mima1-tips"></p>
                    </li>
                    <li class="register-li">
                        <input type="text" title="请输入6到16位字母数字_$符号的密码" placeholder="重复密码" id="register-pwd1">
                        <p class="zhuanghu-tips" id="mima2-tips"></p>
                    </li>
                    <li class="register-btn">
                        <input type="checkbox" class="registerbtn" id="registerbtn">
                        <span>我已阅读并同意遵守 法律声明 和 隐私条款</span>
                    </li>
                    <li><button class="register-zhuce" id="register-zhuce">注册</button></li>
                </ul>
            </div>
        </div>
    </div>


</body>

<script src="//apps.bdimg.com/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="//apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
<script src="../js/config.js"></script>
<script src="../js/jquery-1.10.1.min.js"></script>
<script src="../js/login.js"></script>
<script src="../js/regidter.js"></script>

</html>
<script>
     $(".selecta").css({"border":"0"});
$(".furniture").hover(function(){
$(".selecta").css({"border-bottom":"2px #000 solid"});
},function(){
    $(".selecta").css({"border":"0"});
})
    // 动态生成
    $.ajax({
        type: "get",
        url: "../php/shoppingcar.php",
        data: {
            userid: getCookie("userid")
        },
        dataType: "json",
        success: function (result) {
            var html="";
            $(".detail").html();
                result.forEach(function(item){
                    var {
                        id,
                    goodsid,
                    goodsname,
                    goodsprice,
                    goodskid,
                    goodsimg,
                    goodstype,
                    goodsnum,
                }=item;

                html+=`<div class="item">
                        <input type="checkbox" name="" class="check-one"  data-id=${id}>
                        <div class="img">
                            <a><img src="../images/details/${goodsimg}"  width="100px"></a>
                        </div>
                        <span class="title doubleline"><a>${goodsname}</a></span>
                        <div class="guige">${goodskid}</span>
                        </div>
                        <span class="danjia">${goodsprice}元</span>
                        <ul class="count">
                            <li class="reduce">-</li>
                            <li>
                                <input data-id=${id} type="text" name="goods_number[42046]" id="count-input" value="${goodsnum}" size="4"
                                    class="txtcount">
                            </li>
                            <li class="add">+</li>
                        </ul>
                        <span class="sum">${(goodsprice*goodsnum).toFixed(2)}元</span>
                        <span class="dele" data-id=${id} >x</span>
                    </div> `
                })
//全选
                $(".detail").append(html);
                var maxCount = $(".check-one").length;
    var count = 0;
    $(".check-all").click(function () {
        // alert($(this).prop("checked")) //状态选择 用prop   普通的属性用attr
        $(".check-one").prop("checked", $(this).prop("checked"));

        count = $(this).prop("checked") ? maxCount : 0;

    })
// 单选
    $(".check-one").click(function () {
        if ($(this).prop("checked")) {
            count++;
        } else {
            count--;
        }
        if (count == maxCount) {
            $(".check-all").prop("checked", true);
        } else {
            $(".check-all").prop("checked", false);
        }
        showSumPrice()
    });
    // 删除
    $(".dele").click(function(){
        var id=$(this).attr("data-id")
        $.ajax({
            type:"get",
            url:"../php/deleshoppingcar.php",
            data:{
                id:id,
                userid:getCookie("userid")
            },
            dataType:"json",
            success:function(data){
                if(data["code"]==1){
                    confirm(data["msg"]);
                }else{
                    confirm(data["msg"])
                }
            }
        })
      $(this).parent().remove();
      showSumPrice()
    })
        }
        })
//jianhao
        $(document).on("click", ".reduce", function () {
        var jiage = parseInt($(this).parent().prev().html());//找到价格
        var zongjia = $(this).parent().next().html();
        var num1 = $(this).next().children().val();
        num1--;
        $(this).next().children().val(num1);
        $(this).parent().next().html(jiage * num1 + ".00元");
        if (num1 <= 1) {
            num1 = 1;
            $(this).next().children().val("1");
            $(this).parent().next().html(jiage + ".00元");
        }
        var id = $(this).next().children().attr("data-id");
// ?userid=5&id=9&goodsnum=3
        $.ajax({
            type:"get",
            url:"../php/carnumb.php",
            data:{
                id:id,
                userid:getCookie("userid"),
                goodsnum:num1
            },
            dataType:"json",
            success:function(data){
                console.log(data);
            }
        })
        showSumPrice();
    });
    // jiahao
    $(document).on("click", ".add", function () {
        var jiage = parseInt($(this).parent().prev().html());
        var zongjia = $(this).parent().next().html();
        var num = $(this).prev().children().val();
        num++;
        $(this).parent().next().html(jiage * num + ".00元");
        $(this).prev().children().val(num);
        var id= $(this).prev().children().attr("data-id");
        $.ajax({
            type:"get",
            url:"../php/carnumb.php",
            data:{
                id:id,
                userid:getCookie("userid"),
                goodsnum:num
            },
            dataType:"json",
            success:function(data){
                console.log(data);
            }
        })
        showSumPrice()
    });


//     if ($("#checkbox-id")[0].checked) {
//     // do something
// }
// 多选
// 总计
function showSumPrice() {
    var price = 0;
    $(".check_one").each(function () {
        if ($(this).prop("checked")) {
            price += $(this).next().next().next().next().next().next().html() * 1;
        }
    });
    
    $("#price").html(price);
}


    // $(".check-one").each(function(i){

    // })


    // 头部登录注册
    // 获取焦点把内容替换
    $("#login-tu").hover(function () {

        $("#login-tu").html(" <a id='register' style='cursor: pointer' >注册</a> /<a id='login' style='cursor: pointer'>登录</a> ");

    }, function () {
        $("#login-tu").html("<img src='../images/index/top4.png'>");

    });

   // 退出
   if (getCookie("username")) {
        $("#login-tu").hide();
        $("#denglu-suce").show();
        $("#cancle-top").hide();
        $("#denglu-suce").hover(function () {
            $("#cancle-top").show();
            $("#cancle-top").click(function () {
        $("#login-tu").show();
        $("#denglu-suce").hide();
        setCookie("username","", -7);
        setCookie("userid","", -7);
        window.location.reload();
    })
        }, function () {
            $("#cancle-top").hide();
        })
    };
    //
    $(window).scroll(function () {
        var height = parseInt($("#top").css("height"));
        if ($(window).scrollTop() >= height) {
            $("#header").css({ "position": "fixed", "top": "0", "left": "0", "z-index": "10" })
        }
        if ($(window).scrollTop() <= height) {
            $("#header").css("position", "static");
        }
    });

    function getStyleAttr(obj, attr) {
        if (window.getComputedStyle) {
            return window.getComputedStyle(obj)[attr];
        } else {
            return obj.currentStyle[attr];
        }
    }
</script>